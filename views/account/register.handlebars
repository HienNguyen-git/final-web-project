
<h3 class="text-center my-5">Account Registration</h3>

<!-- buộc toàn bộ dòng và cột phải bỏ trong class container -->
<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-10 col-lg-8 col-xl-5">
      <div class="border p-3 rounded bg-light">
        <form id="form-register" method="post" enctype="multipart/form-data">
          <div class="form-group">
            <label for="user">Phone number</label>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text">
                  <i class="fas fa-user"></i>
                </span>
              </div>
              <input id="phone" type="text" name="phone" class="form-control" placeholder="Phone number">
            </div>

          <div class="form-group">
            <label for="user">Email</label>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text">
                  <i class="fas fa-user"></i>
                </span>
              </div>
              <input id="email" type="text" name="email" class="form-control" placeholder="Email">
            </div>

          </div>
          <div class="form-group">
            <label for="pass">Full Name</label>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text">
                  <i class="fas fa-lock"></i>
                </span>
              </div>
              <input type="text" name="name" id="name" class="form-control" placeholder="Full name">
            </div>
          </div>
          <div class="form-group">
            <label for="pass">Date of birth</label>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text">
                  <i class="fas fa-lock"></i>
                </span>
              </div>
              <input type="date" name="date_of_birth" id="date_of_birth" class="form-control" placeholder="Date of birth">
            </div>
          </div>
          <div class="form-group">
            <label for="pass">Address</label>
            <div class="input-group mb-3">
              <div class="input-group-prepend">
                <span class="input-group-text">
                  <i class="fas fa-lock"></i>
                </span>
              </div>
              <input type="text" name="address" id="address" class="form-control" placeholder="Address">
            </div>
          </div>
          {{!-- <div class="form-group">
            <label for="pwd">Avatar:</label>
            <input type="file" id="font_cmnd" placeholder="Enter avatar" name="font_cmnd" required class="form-control">
          </div> --}}
          <div class="form-group">
              <label for="customFile">Front CMND:</label>
              <div class="custom-file">
                <input type="file" class="custom-file-input" id="customFile" name="image" >
                <label class="custom-file-label" for="customFile">Choose picture</label>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12">
                <div class="preview-images"></div>
              </div>
            </div>
          </div> 
          <div class="form-group">
              <label for="customFile">Back CMND:</label>
              <div class="custom-file">
                <input type="file" class="custom-file-input" id="customFile" name="image" >
                <label class="custom-file-label" for="customFile">Choose picture</label>
              </div>
            </div>
            <div class="row">
              <div class="col-sm-12">
                <div class="preview-images"></div>
              </div>
            </div>
          <div class="form-group" id="my-alert"></div>
          <div class="form-group">
            <button class="btn btn-success px-5" type="submit">Register</button>
          </div>
          <div class="form-group">
            <p>Already have an account? <a href="/users/login">Login now!</a></p>
          </div>
          </div> 
        </form>
      </div>
    </div>
  </div>
</div>

<script>
    const formRegister = document.getElementById('form-register')
    const myAlert = document.getElementById('my-alert')
    if(formRegister){
        formRegister.addEventListener('submit',async e=>{
            e.preventDefault()
            const formData = new FormData(e.target)
            const {phone, email, name, date_of_birth, address} = Object.fromEntries(formData);
            //if()
            if(phone===undefined){
              showAlert("Please enter your phone")
            }else if(email===undefined){
              showAlert("Please enter your email")
            }else if(name===undefined){
              showAlert("Please enter your name")
            }else if(date_of_birth===undefined){
              showAlert("Please enter your date of birth")
            }else if(address===undefined){
              showAlert("Please enter your address")
            }else{
              myAlert.innerHTML =""
              const myFetch = await fetch(location.href,{
                method: "POST",
                body: JSON.stringify({
                  phone,
                  email,
                  name,
                  date_of_birth,
                  address
                }),
                headers: {
                    'Content-Type': 'application/json'
                },
              })
              const res =  await myFetch.json()
              console.log(res)
              if(!res.code){
                alert('Create account successful. Please check your email to get your account!')
              }else{
                showAlert(res.message)
              }
            }
        })
    }

    function showAlert(message){
      myAlert.innerHTML = ""
      const content = `
        <div class="alert alert-danger" role="alert">
          ${message}
        </div>
      `
      myAlert.insertAdjacentHTML('beforeend', content)
    }
</script>
